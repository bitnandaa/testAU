var cmsCtrl = function(){

    "use strict";
    
    // 지속가능한 경영 추진보고서 세팅
    //if(location.href.indexOf("/sustainable-management/report/") > -1)
    if(location.href.indexOf("/sustainable-management/esg/") > -1)
    {
        $.ajax({
            url : "./file.ajax",
            type : "post",
            timeout : 30000,
            dataType : "json",
            async : true,
            cache : false,
            success : function(data, status, xhr){
                if(data.fileMap)
                {
                
	                var yearSelect = $("#cont_wrap").find("#year_select");
	                $("#year_select option:eq(0)").val(data.fileMap[0].year);
	                
                	for(var i = 0; i < data.fileMap.length; i++) {     
	                    var fileMap = data.fileMap[i];
	                    var trgtDiv = $("#cont_wrap").find(".download_box:eq("+i+")");
	                    var option = $("<option value='"+fileMap.year+"'>" + fileMap.year + "</option>");
	                    
	                    yearSelect.append(option);
	                    
	                   	trgtDiv.find("span").text(fileMap.year);
	                    var downUrl = "location.href='/cmm/fms/FileDown.do?fileId=" +fileMap.atchFileId+ "&fileSn=" +fileMap.atchFileSeq+"&fileYear="+fileMap.year+"'";
	                    trgtDiv.find("button").eq(0).attr(
	                    "onclick",downUrl
	                    );
	                    downUrl = "location.href='/cmm/fms/FileDown.do?fileId=" +fileMap.atchFileId2+ "&fileSn=" +fileMap.atchFileSeq2+"&fileYear="+fileMap.year+"'"; 
	                    trgtDiv.find("button").eq(1).attr(
	                    "onclick",downUrl
	                    );
                    }
                }
                else
                {
                    $("#cont_wrap").find(".esg_report_area").hide();
                }
            },
            error : function(data, status, xhr){
                if (data.status > 0)
                {
                    alert("A problem has occurred and the process has been interrupted. \nPlease try again later.");
                }
            }
            
        });
    }else{
    $('.download').click(function(){
        var fileName = $(this).data().fileName;
        location.href="/cmm/download.do?subPath="+encodeURI(fileName);
    });
 } 
    //개인정보처리방침 해당 페이지
    if(location.href.indexOf("/overseas-corporation/europe/") > -1 || location.href.indexOf("/overseas-corporation/brazil/") > -1)
    {
        if(location.href.indexOf("/overseas-corporation/europe/") > -1)
        {
            europeHeaderTabMove(); 
        }   
        else
        {
            businessHeaderFocusMove();
        }
        
        $(".gnb li").click(function(){
            $(".business_area").show();
            $(".policy_div").hide();
            $(".visual_tit").text($(".business_area").data("title")); 
        })
    }
 //연도별로 다운로드 파일 노출   
      $("#year_select").change(function(){
   		var year = $(this).val();
   		var trgtDiv = $("#cont_wrap").find(".download_box");
   		
   		trgtDiv.find("button").attr("onclick",'');
   		
   		$.ajax({
            url : "./file.ajax",
            type : "post",
            timeout : 30000,
            dataType : "json",
            async : true,
            cache : false,
            success : function(data, status, xhr){
                if(data.fileMap)
                {        
                	for(var i = 0; i < data.fileMap.length; i++) {     
	                    var fileMap = data.fileMap[i];
					
						if(fileMap.year == year){
		                    var downUrl = "location.href='/cmm/fms/FileDown.do?fileId=" +fileMap.atchFileId+ "&fileSn=" +fileMap.atchFileSeq+"&fileYear="+fileMap.year+"'";
		                    trgtDiv.find("button").eq(0).attr("onclick",downUrl);
		                    
		                 	downUrl = "location.href='/cmm/fms/FileDown.do?fileId=" +fileMap.atchFileId2+ "&fileSn=" +fileMap.atchFileSeq2+"&fileYear="+fileMap.year+"'"; 
		                    trgtDiv.find("button").eq(1).attr("onclick",downUrl);
		                }
                    }
                }
            },
            error : function(data, status, xhr){
                if (data.status > 0)
                {
                    alert("A problem has occurred and the process has been interrupted. \nPlease try again later.");
                }
            }
        });
   })
    return {    
        
    }
}();