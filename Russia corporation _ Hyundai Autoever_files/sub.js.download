var _nowScrollTop;          // scrollTop 변수
var _irScheduleSwiper;      // IR > 개요 스와이퍼 변수
var _isFirst = false; // 스크롤 함수에서 한번만 타도록 하는 변수

var subScript = (function(){
  return {
    deviceChk : function(){
      // 디바이스 체크
      if(/Android/i.test(navigator.userAgent)) {
        _device = 'android';
      } else if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
        return navigator.userAgent.match(/(iPhone|iPod)/g) ? device='ios' : device='ipad';
      }else {
        _device = 'pc';
      }

      // 브라우저 체크
      var agent = navigator.userAgent.toLowerCase(),
        name = navigator.appName;

      if(name === 'Microsoft Internet Explorer' || agent.indexOf('trident') > -1 || agent.indexOf('edge/') > -1) {
        _browser = 'ie';
        $("#wrap").addClass("ie");
      } else if(agent.indexOf('safari') > -1) { // Chrome or Safari
        _browser = 'chrome';
      } else if(agent.indexOf('firefox') > -1) { // Firefox
        _browser = 'firefox';
      }
    },
    commonMotion: function(){
      scrollMotionTrigger();

      $(".btn-scroll-down").hover(function(){
        $(".btn-scroll-down").addClass("on");
      }, function(){
        $(".btn-scroll-down").removeClass("on");
      })

      $(".sticky-area .navigation .button-open").on("click", function(){        
        if(!$(this).parents(".navigation").hasClass("clicked")){
          $(this).parents(".navigation").addClass("clicked");
          $(".dimd").stop().fadeIn(300);
        }
      });

      $(".sticky-area .navigation .button-close").on("click", function(){
        $(".sticky-area .navigation").removeClass("clicked");
        $(".dimd").stop().fadeOut(300);
      });

      $(".btn-scroll-down").on("click", function(){
        gsap.to(("html, body"), 1, {scrollTop:$(window).height(), ease:Power3.easeOut});
      });
      
      //3depth bar menu 클릭 시 나오는 이벤트
      $(".thr_dep_div .menu_btn").on("click", function(){
        $(".thr_dep_div .open_div").fadeIn(200);
        TweenMax.to($(".open_div > a").not(":first-child"), 0.25, {top:72, opacity:1, ease:Power3.easeOut, onComplete:function(){
          TweenMax.to($(".url_btn"), 0.25, {top:144, ease:Power3.easeOut})
        }})
      });

      $(".thr_dep_div .close_btn").on("click", function(){
        $(".thr_dep_div .open_div").fadeOut(300);
        TweenMax.to($(".open_div > a").not(":first-child"), 0.25, {top:0, opacity:0, ease:Power3.easeOut})
      });

      /* 공유 버튼 이벤트  */
      $(".share_btn").on("click", function(){
        $(".share_div").fadeIn();
      });

      $(".share_div .close").on("click", function(){
        $(".share_div").fadeOut(200);
      });

      /* 서브페이지 visual 영역 모션 */
      if($(".sub_visual").size() != 0){
        TweenMax.to($(".sub_visual .visual_div"), 2.3, {scale:1, ease:Power3.easeOut});
      }

      if($(".overview_area").size() > 0){
        if(window.innerWidth < 1024){
          $(".overview_area .txt_area").addClass("active")
        }
      }

    },
    subMotion: function(){
      // ETC > 사이트맵
      if($(".site_map").size() != 0){
        $(".site_map .gnb > li").each(function(q){
          $(this).find(".one_depth").on("click", function(){
            if($(this).parents("li").hasClass("on")){
              $(this).parents("li").removeClass("on");
              $(this).next().slideUp(300);
              $(this).attr("title", "하위 메뉴 열기");
            }else{
              $(this).parents("li").addClass("on");
              $(this).next().slideDown(300);
              $(this).attr("title", "하위 메뉴 닫기");
            }
          });
        });

        $(".site_map .gnb > li .two_pack > li").each(function(q){
          $(this).on("mouseenter", function(){
            $(".site_map .gnb > li .two_pack > li").removeClass("on");
            $(this).addClass("on");
          });

          $(this).on("mouseleave", function(){
            $(".site_map .gnb > li .two_pack > li").removeClass("on");
          });
        });
      }

      // our field 스마트 교통 팝업
      if($(".illu_pop_area").size() > 0){
        $(".illu_img map").each(function(){
          $(this).find("area").each(function(q){
            $(this).on("click", function(){
              if(!$(this).hasClass("on")){
                $(".illu_img map area").attr("title","선택안됨");
                $(this).attr("title","선택됨");
                $(".illu_img map area").removeClass("on");
                $(this).addClass("on");
                $(".illu_pop_area .info_pop").removeClass("on");
                $(".illu_pop_area .info_pop").eq(q).addClass("on");
                $(".illu_pop_area .info_pop").eq(q).find(".con").focus()
              }else{
                $(".illu_pop_area .info_pop").eq(q).find(".con").focus()
              }
            });
          });
        })
        

        $(".illu_pop_area .info_pop").each(function(k){
          $(this).find(".pop_close").on("click", function(){
            $(this).parent(".info_pop").removeClass("on");
            $(".illu_img map area").removeClass("on");
            $(this).parents(".info_pop_div").siblings(".illu_img").find("map area").eq(k).focus()
            $(".illu_img map area").eq(k).attr("title","선택안됨");
          })
        })
      }

      // about us 모바일 헤더
      if($("header.business").size() > 0){
        $("header.business .current").on("click", function(){
          if(!$(this).hasClass("on")){
            $(this).addClass("on");
            $("header.business .gnb").stop(true, true).slideDown();
          }else{
            $(this).removeClass("on");
            $("header.business .gnb").stop(true, true).slideUp();
          }
        });
      }

      // about us > 사업장 > 스크롤 관련 함수 호출
      if(!$(".business_area").hasClass("europe") && !$(".business_area").hasClass("brazil")){
        europeHeaderTabMove();
        businessHeaderFocusMove();
      }

      if($(".sub_our_field .overview_area").size() > 0){
        TweenMax.to($(".overview_area .tit_div"), 3, {opacity:1, ease:Power3.easeOut})
      }
      
      //TweenMax.to($(".overview_area .bg img"), 0, {top:$(window).scrollTop()*0.14, ease:Power3.easeOut});

      // 테이블 스와이핑
      // if($(".swipe_icon").size() > 0){
      //   $(".swipe_icon").on("click", function(){
      //     $(".swipe_icon").fadeOut();
      //   });
      // }

      // our field 스마트 교통 이미지 맵
      if($("#smart_traffic").size() > 0){
        $('img[usemap]').rwdImageMaps();
        $("#smart_traffic").width("100%");
        $("#smart_traffic_m").width("100%");
      }

      if($(".sub_about_us .company_info").size() > 0){
        $("#cont_wrap").removeAttr("style")
      }
    },
    resizeEvt:function(){
      $(window).resize(function(){
        if($(".company_info .fixed_visual .bg_area").size() > 0){
          if($(window).scrollTop() < $(".company_info .fixed_visual").offset().top){
            $(".company_info .fixed_visual .bg_area .trigger").height(window.innerHeight);
          }
        }

        // our field 개요 기준점 박스
        if($(".sub_our_field .overview_area").size() > 0){
          if(window.innerWidth >= 1024){
            $(".sub_our_field .overview_area .tit_standard_box").height($(".sub_our_field .overview_area .tit_area").height())
          }
        }

        if(window.innerWidth > 768){
          if($(".ir_schedule .swiper-container").size() != 0){
            $(".card_list_swiper").addClass("not_swiper");
  
            if(_irScheduleSwiper.destroyed != true){
              _irScheduleSwiper.destroy();
            }
          }
        }else{
          if($(".ir_schedule .swiper-container").size() != 0){
            $(".card_list_swiper").removeClass("not_swiper");
  
            if(_irScheduleSwiper.destroyed == true){
              _irScheduleSwiper = new Swiper('.card_list_swiper .swiper-container', {
                slidesPerView: 1,
                scrollbar: {
                  el: '.card_list_swiper .swiper-scrollbar'
                },
                navigation: {
                  nextEl: '.card_list_swiper .swiper-button-next',
                  prevEl: '.card_list_swiper .swiper-button-prev',
                },
              });
            }
          }
        }

        if(window.innerWidth < 1024 && window.innerWidth >= 768){
          $(".service_sec .fixed_area .img_box").removeAttr("style");
          $(".service_sec .fixed_area .img_box .fade_img").removeClass("show");
          $(".cloud_bg_area").removeAttr("style");
          $(".cloud_bg_area .bg").removeAttr("style");

        }else if(window.innerWidth < 768){
        }else{
          // about us 모바일 헤더
          if($("header.business").size() > 0){
            $("header.business .gnb").removeAttr("style");
            $("header.business .current").removeClass("on")
          }
        }

        if($(".cloud_area.car_area").size() > 0){
          if(window.innerWidth < 1024){
            $(".cloud_txt_div .of_small_tit").removeClass("font_white")
          }
        }

        /* our field 인공지능 3개 이미지 영역 */
        if($(".thr_img_area").size() > 0){
          if(window.innerWidth <= 1366 && window.innerWidth >  1023){
            //console.log($(".thr_img_area .img:nth-child(1)").innerHeight())
            //console.log($(".thr_img_area .img:nth-child(3)").outerHeight())
            $(".thr_img_area .img:nth-child(2)").outerHeight($(".thr_img_area .img:nth-child(1)").innerHeight() + $(".thr_img_area .img:nth-child(3)").outerHeight() + 40)
          }else{
            $(".thr_img_area .img:nth-child(2)").removeAttr("style")
          }
        }

        if($(".side_white_bg").size() > 0){
          if(window.innerWidth >= 1024){              
            $(".cloud_area .cloud_bg_area .side_white_bg").css("width" , window.innerWidth);
            $(".cloud_area .cloud_bg_area .bg").css("width" , window.innerWidth);
            
            var bottomBgH = window.innerHeight - 840;
            $(".side_white_bg .bottom_bg").css("height", bottomBgH);

            if(!$(".cloud_area").hasClass("in")){
              var sideBgW = (window.innerWidth - 840) / 2;
              $(".side_white_bg .left_bg").css("width", sideBgW);
              $(".side_white_bg .right_bg").css("width", sideBgW);
            }
          }
        }

      });$(window).resize()
    },
    scrollMotion: function(){
      // not IE
      $(window).on("scroll", function(){
        _nowScrollTop =  $(window).scrollTop();

        // 3depth sticky
        if($(".thr_dep_area").size() > 0){
          if(_nowScrollTop >= $(".thr_dep_area").offset().top){
            $(".thr_dep_div").addClass("fixed");
          }else if(_nowScrollTop < $(".thr_dep_area").offset().top){
            $(".thr_dep_div").removeClass("fixed");
          }
        }

        // 빌링시스템 개인정보처리방침
        if($(".terms_div").size() > 0){

          // if(window.innerWidth >= 1024){
          //   if(_nowScrollTop > $(".policy_area").offset().top - 100){
          //     $(".policy_area .fixed_area").addClass("fixed");
          //   }else{
          //     $(".policy_area .fixed_area").removeClass("fixed");
          //   }
          // }
          

          if(!_isFirst){
            $(".fixed_area .box_btn").on("click", function(){
              if(window.innerWidth >= 768){
                TweenMax.to($(("html, body")), 0, {scrollTop:$(".terms_div").eq(0).offset().top - 150, ease:Power3.easeOut});
              }else{
                TweenMax.to($(("html, body")), 0, {scrollTop:$(".terms_div").eq(0).offset().top - 90, ease:Power3.easeOut});
              }
              
              _isFirst = true;
            })
          }

          $(".policy_area .select_wrap select").on("change", function(){
            var selectIndex = $(".policy_area .fixed_area .select_wrap select option:selected").index();
            
            $(".fixed_area .box_btn").on("click", function(){
              if(window.innerWidth >= 768){
                TweenMax.to($("html, body"), 0, {scrollTop:$(".terms_div").eq(selectIndex).offset().top - 150, ease:Power3.easeOut});
              }else{
                TweenMax.to($("html, body"), 0, {scrollTop:$(".terms_div").eq(selectIndex).offset().top - 90, ease:Power3.easeOut});
              }
              $(".terms_div").eq(selectIndex).find(".con_tit").focus();
            })
          });
        }


        // Sustainability > 공정거래 > Compliance관련활동
        if($(".active_his").size() > 0){
          $(".active_his .divided_area .box.right .list_wrap").each(function(q){
            if(_nowScrollTop + $(window).height()*0.2 > $(".active_his .divided_area .box.right .list_wrap").eq(q).offset().top){
              $(".active_his .divided_area .box.left .year_txt .list").hide();
              $(".active_his .divided_area .box.left .year_txt .list").eq(q).show();
            }
          });
        }


        /* Sustainability - 불공정거래 행위 제보 */
        if($(".report_center").size() > 0){
          if($(window).scrollTop() + $(window).height() >= $(".scroll_bg").offset().top){
            TweenMax.to($(".scroll_bg .bg img"), 1, {top:-200 + ($(window).scrollTop() + $(window).height() - $(".scroll_bg").offset().top)*0.14, ease:Power3.easeOut});
          }
        }

        // About us 기업성장
        // if($(".sub_about_us").size() > 0){
        //   if($(window).scrollTop() + $(window).height()/2 + 250 >= $(".company_info .visual_area").offset().top){
        //     TweenMax.to($(".company_info .visual_area"), 0.9, {width:"100%", ease:Power3.easeOut})
        //   }
        // }
      });$(window).scroll();

      /*var isBodyScroll = false;
      var secNum = 0;

      $(window).on('mousewheel DOMMouseScroll', function(e) {
        var E = e.originalEvent;
        delta = 0;
        if (E.detail) {
        }else{
          delta = E.wheelDelta;
          deltaY = E.deltaY
          if(delta > 0){
            // up
            //console.log("up 마우스휠");
          }else{
            // down
            if(isBodyScroll == false){
              if($(".sus_growth_sum").hasClass("fixed")){
                if(secNum == 0){
                  isBodyScroll = true;
                }
              }
            }
          }
        }
      });*/
    },
    swiperEvt : function(){
      var fidoSwiper = new Swiper('.fido_slide .swiper-container', {
        effect: 'fade',
        speed:500,
        allowTouchMove:false,
        navigation: {
          nextEl: '.fido_slide .swiper-button-next',
          prevEl: '.fido_slide .swiper-button-prev',
        },
        on:{
          init : function(){
            $(".slide_btn").each(function(q){
              $(this).on("click", function(){
                if(!$(this).hasClass("on")){
                  $(".slide_btn").removeClass("on");
                  $(this).addClass("on");
                  fidoSwiper.slideTo($(".fido_slide .swiper-container .swiper-slide").eq(q).index(), 500);
                }else{
                  $(this).removeClass("on");
                }
              })
            });
          },
          slideChangeTransitionStart : function(){
            $(".fido_slide .swiper-container .swiper-slide .txt_box").removeClass("first");
            $(".fido_slide .swiper-container .swiper-slide").removeClass("first");
            TweenMax.to($(".fido_slide .swiper-container .swiper-slide").find(".txt_box"), 0, {top:50, opacity:0, ease:Power3.easeOut})
            $(".slide_btn").removeClass("on");
            $(".slide_btn").eq(this.activeIndex).addClass("on");
          },
          slideChangeTransitionEnd : function(){
            TweenMax.to($(".fido_slide .swiper-container .swiper-slide").eq(this.activeIndex).find(".txt_box"), 0.6, {top:0, opacity:1, ease:Power3.easeOut});
          },
        }
      });

      var exSwiper = new Swiper('.ex_swiper.swiper-container', {
        slidesPerView:"auto",
        scrollbar: {
          el: '.swiper-scrollbar'
        },
        navigation: {
          nextEl: '.ex_swiper .swiper-button-next',
          prevEl: '.ex_swiper .swiper-button-prev',
        },
      });


      /* 사업장 */
      var businessSwiper = new Swiper('.sub_visual_swiper .swiper-container', {
        effect : "fade",
        speed:500,
        loop:true,
        autoplay: {
          delay: 3000,
          disableOnInteraction: false,
        },
        navigation: {
          nextEl: '.sub_visual_swiper .swiper-button-next',
          prevEl: '.sub_visual_swiper .swiper-button-prev',
        },
        pagination: {
          el: ".swiper-pagination",
        }
      });

      /* IR > 개요 */
      _irScheduleSwiper = new Swiper('.card_list_swiper .swiper-container', {
        slidesPerView: 1,
        scrollbar: {
          el: '.card_list_swiper .swiper-scrollbar'
        },
        navigation: {
          nextEl: '.card_list_swiper .swiper-button-next',
          prevEl: '.card_list_swiper .swiper-button-prev',
        },
        on : {
          init: function(){
          },
        },
      });
    },
    triggerEvt : function(){
      // about us 개요 > 연혁
      if($(".about_his").size() != 0){
        // pin 영역
        $(".about_his .his_list .img_wrap").each(function(q){
          gsap.to($(this), {
            scrollTrigger: {
              trigger: $(this),
              start: "top top",
              endTrigger: $(this).parents(".his_list").find(".txt_wrap"),
              end:"bottom bottom",
              pin: true,
              invalidateOnRefresh: true,
              //toggleClass: {targets: $(".about_his .his_list").eq(q), className: "active"},
              //markers: true,
            },
          });
        });

        // width 줄이는 영역
        $(".about_his .his_list").each(function(q){
          gsap.to($(this).find(".img_area"), {
            scrollTrigger: {
              trigger: $(this),
              start: "top top",
              end:"+=85%",
              //scrub: 1,
              scrub: true,
              //markers: true,
              //invalidateOnRefresh: true,
              toggleClass: {targets: $(".about_his .his_list").eq(q), className: "active"},
              onUpdate: function(self){
                if(window.innerWidth >= 1024) {
                  gsap.to($(".about_his .his_list").eq(q).find(".img_wrap .img_area"), 0.5, {width:100 - (self.progress.toFixed(3) * 50) + "%", ease:Power3.easeOut});
                } else if(window.innerWidth >= 768 && window.innerWidth < 1024){
                  gsap.to($(".about_his .his_list").eq(q).find(".img_wrap .img_area"), 0.5, {width:100 - (self.progress.toFixed(3) * 70) + "%", ease:Power3.easeOut});
                } else if(window.innerWidth < 768){
                  gsap.to($(".about_his .his_list").eq(q).find(".img_wrap .img_area"), 0.5, {width:100 - (self.progress.toFixed(3) * 83) + "%", ease:Power3.easeOut});
                }
              },
              onLeave: function(){
                $(".about_his .his_list").eq(q).addClass("on_leave");
              },
              onEnterBack: function(){
                $(".about_his .his_list").eq(q).removeClass("on_leave");
              },
            },
          })
        });
      }

      if($(".sub_about_us .fixed_visual").size() > 0){
        ScrollTrigger.matchMedia({
          "(min-width : 1024px)": function(){
            gsap.to(".fixed_visual", {
              scrollTrigger: {
                trigger: ".bg_area",
                start: "0 0",
                //end:"bottom bottom",
                endTrigger: $(".company_info .fixed_visual .txt_div:last-child"),
                end:"top bottom",
                //scrub: true,
                pin:true,
                //markers: true,
                //toggleClass: {targets: $(this), className: "active"}
                onUpdate: function(self){
                  //$("#cont_wrap").removeAttr("style");
                },
              },
            });
            
            $(".sub_about_us .fixed_visual .bg_area .trigger").each(function(q){
              gsap.to($(this), {
                scrollTrigger: {
                  trigger:$(".company_info .fixed_visual .txt_div").eq(q),
                  start: "+=100% bottom",
                  endTrigger: $(".company_info .fixed_visual .txt_div").eq(q+1),
                  end: "top bottom",
                  //end: "bottom+=100% bottom",
                  scrub:true,
                  //pin: false,
                  //markers: true,
                  toggleClass: {targets: $(".sub_about_us .fixed_visual .bg_area .trigger").eq(q), className: "active"},
                  onUpdate: function(self){
                    $(".company_info .fixed_visual .trigger.active").height($(window).height() - (self.progress.toFixed(3)*1700))
                  },
                },
                height: 0,
                ease:"none"
              });
            });

            $(".sub_about_us .fixed_visual .txt_div").each(function(q){
              gsap.to($(this), {
                scrollTrigger: {
                  trigger:$(this),
                  start: $(".fixed_visual").offset().top + $(window).height()*q + $(".txt_div").innerHeight()*(q+1),
                  end: $(".fixed_visual").offset().top + $(window).height()*(q+1) + $(".txt_div").innerHeight()*(q+1),
                  scrub:false,
                  //pin: false,
                  //markers: true,
                  toggleClass: {targets: $(this), className: "active"}
                },
              });
            });
          }
        });
      }

      // our field 이미지 parallax 공통 스크립트
      if($(".parallax_area").size() != 0 ){
        gsap.to($(".parallax_area .parallax_img img"), {
          scrollTrigger: {
            trigger: $(".parallax_area .parallax_img"),
            start: "top bottom",
            end:"+=200%",
            scrub: true,
            scrub: 1,
            //markers: true,
            onUpdate : function(self){
              if(window.innerWidth >= 1024){
                gsap.to($(".parallax_area .parallax_img img"), 0.8, {marginTop:(self.progress.toFixed(3) * 100) * 5, ease: Power1.easeOut});
                //console.log($(".parallax_area .parallax_img img").css("margin-top"));
              } else if(window.innerWidth >= 768 && window.innerWidth < 1024){
                gsap.to($(".parallax_area .parallax_img img"), 0.8, {marginTop:(self.progress.toFixed(3) * 100) * 3, ease: Power1.easeOut});
              } else if(window.innerWidth < 768){
                gsap.to($(".parallax_area .parallax_img img"), 0.8, {marginTop:(self.progress.toFixed(3) * 100) * 1, ease: Power1.easeOut});
              }
            },
          },
          //top: 600,
        });

        gsap.to($(".parallax_area .parallax_img"), {
          scrollTrigger: {
            trigger: $(".parallax_area .parallax_img"),
            start: "top bottom",
            end:"+=200%",
            scrub: 1,
            //markers: true,
          },
          top: -50,
        });

        gsap.to($(".parallax_area .parallax_txt"), {
          scrollTrigger: {
            trigger: $(".parallax_area"),
            start: "top bottom",
            end:"+=200%",
            scrub: 1,
            //markers: true,
          },
          top: 0,
        });
      }

      // our field deco 이미지
      if($(".move_deco_wrap").size() != 0 ){
        $(".move_deco_wrap ").each(function(q){
          gsap.to($(this).find(".deco").not( '.deco.fixed' ), {
            scrollTrigger: {
              trigger: $(this),
              start: "top bottom",
              end:"+=150%",
              scrub: 1,
              //markers: true,
            },
            marginTop: -100,
          });
        });
      }

      // Sustainability > 동반성장 개요
      if($(".sus_growth_sum").size() > 0 && $("html").hasClass("ie")){
        $(".scrollMotion").each(function(q){
          gsap.to($(this), {
            scrollTrigger: {
              trigger: $(this),
              start: "top 80%",
              end:"top top",
              //markers: true,
              //toggleClass: {targets: $(this), className: "active"},
              onEnter: function(self){
                $(".scrollMotion").eq(q).addClass("active");
              },
              onUpdate: function(){
              },
            },
          });
        });
      }

      // About us > 사업장 > 유럽법인 (About)
      if($(".active_his").size() > 0){
        ScrollTrigger.matchMedia({
          "(min-width : 1024px)": function(){
            gsap.to(".active_his .divided_area .box.right .list_wrap .list:first-child", {
              scrollTrigger: {
                trigger: $(".active_his .divided_area .box.left .history_txt"),
                start: "0 184px",
                endTrigger: $(".active_his .divided_area .box.right .list_wrap:last-of-type"),
                end:"bottom 420px",
                pin:true,
                //markers: true,
              },
            });
    
            gsap.to(".active_his .divided_area .box.right .list_wrap .list:first-child", {
              scrollTrigger: {
                trigger: $(".active_his .gauge_area"),
                start: "0 220px",
                endTrigger: $(".active_his .divided_area .box.right .list_wrap:last-of-type"),
                end:"bottom 87%",
                pin:true,
                //markers: true,
              },
            });
    
            gsap.to(".active_his .gauge_area .bar", {
              scrollTrigger: {
                trigger: $(".active_his .divided_area .box.right .list_wrap .list:first-child"),
                start: "0 184px",
                endTrigger: $(".active_his .divided_area .box.right .list_wrap:last-of-type"),
                end:"bottom+=240px bottom",
                scrub: true,
                //markers: true,
              },
              height: "100%",
            });
          }
        });
      }
      
      // about us 사업장 service 영역 및 안전보건경영
      if($(".business_area").size() > 0 || $(".safety_health_div").size() > 0){
        ScrollTrigger.matchMedia({
          "(min-width : 1024px)": function(){
            gsap.to(".fixed_area .txt_box", {
              scrollTrigger: {
                trigger: ".fixed_area .img_box",
                start: "-100px 0",
                endTrigger: $(".fixed_area .txt_box"),
                end:"bottom bottom",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                //scrub: true,
                pin:true,
                //markers: true,
                onUpdate : function(self){
                  if(self.progress.toFixed(3) >= 0.4){
                    $(".fixed_area .img_box .fade_img").addClass("show")
                  }else{
                    $(".fixed_area .img_box .fade_img").removeClass("show")
                  }
                }
              },
            });
          }
        });
      }

      /* 2022-05-24 2차 작업 s */
      // our field cloud 영역
      if($(".car_cloud_area").size() > 0){
        ScrollTrigger.matchMedia({
          "(min-width : 1024px)": function(){
            gsap.to(".car_cloud_area .cloud_bg_area", {
              scrollTrigger: {
                trigger: ".car_cloud_area .cloud_bg_area",
                start: "0 0",
                endTrigger: $(".car_cloud_area .cloud_txt_area"),
                end:"bottom bottom",
                //pinSpacing: "padding",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                //scrub: true,
                pin:true,
                //markers: true,
              },
              //height:$(".car_cloud_area").height()
            });

            gsap.to(".car_cloud_area .cloud_bg_area .left_bg", {
              scrollTrigger: {
                trigger: ".car_cloud_area",
                start: "0 0",
                endTrigger: $(".car_cloud_area .cloud_txt_area"),
                end:"bottom bottom",
                //pinSpacing: "padding",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                scrub: true,
                //pin:true,
                //markers: true,
                onUpdate:function(self){
                  //console.log(self.progress.toFixed(3));

                  var sideBgW = (window.innerWidth - 840) / 2;
                  gsap.to($(".car_cloud_area .cloud_bg_area .left_bg"), 0, {width:sideBgW - (self.progress.toFixed(3) * sideBgW), ease: Linear.easeNone});
                }
              },
            });

            gsap.to(".car_cloud_area .cloud_bg_area .right_bg", {
              scrollTrigger: {
                trigger: ".car_cloud_area",
                start: "0 0",
                endTrigger: $(".car_cloud_area .cloud_txt_area"),
                end:"bottom bottom",
                //pinSpacing: "padding",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                scrub: true,
                //pin:true,
                //markers: true,
                onUpdate:function(self){
                  var sideBgW = (window.innerWidth - 840) / 2;
                  gsap.to($(".car_cloud_area .cloud_bg_area .right_bg"), 0, {width:sideBgW - (self.progress.toFixed(3) * sideBgW), ease: Linear.easeNone});
                }
              },
            });

            gsap.to(".car_cloud_area .cloud_bg_area .bottom_bg", {
              scrollTrigger: {
                trigger: ".car_cloud_area",
                start: "-840px 0",
                endTrigger: $(".car_cloud_area .cloud_txt_area"),
                end:"bottom bottom",
                //pinSpacing: "padding",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                scrub: true,
                //pin:true,
                //markers: true,
              },
              height:0
            });

            gsap.to(".car_cloud_area .cloud_bg_area .dimd_bg", {
              scrollTrigger: {
                trigger: ".car_cloud_area",
                start: "0 0",
                endTrigger: $(".car_cloud_area .cloud_txt_area"),
                end:"bottom bottom",
                //pinSpacing: "padding",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                scrub: true,
                //pin:true,
                //markers: true,
              },
              opacity:0.5
            });
    
            gsap.to(".car_cloud_area .cloud_bg_area .bg", {
              scrollTrigger: {
                trigger: ".car_cloud_area .cloud_bg_area .bg",
                start: "0 0",
                endTrigger: $(".car_cloud_area .cloud_txt_area"),
                end:"bottom bottom",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                scrub: true,
                //markers: true,
                onUpdate:function(){
                  $(".car_cloud_area .cloud_txt_area .cloud_txt_div .of_small_tit").addClass("font_white");
                  $(".car_cloud_area").addClass("in")
                },
                onLeaveBack:function(){
                  $(".car_cloud_area .cloud_txt_area .cloud_txt_div .of_small_tit").removeClass("font_white")
                  $(".car_cloud_area").removeClass("in")
                }
              },
              // width:"100%",
              // height:"100vh"
            });


            gsap.to(".cloud_area_origin .cloud_bg_area", {
              scrollTrigger: {
                trigger: ".cloud_area_origin .cloud_bg_area",
                start: "0 0",
                endTrigger: $(".cloud_area_origin .cloud_txt_area"),
                end:"bottom bottom",
                //pinSpacing: "padding",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                //scrub: true,
                pin:true,
                //markers: true,
              },
              //height:$(".cloud_area_origin").height()
            });

            gsap.to(".cloud_area_origin .cloud_bg_area .left_bg", {
              scrollTrigger: {
                trigger: ".cloud_area_origin",
                start: "0 0",
                endTrigger: $(".cloud_area_origin .cloud_txt_area"),
                end:"bottom bottom",
                //pinSpacing: "padding",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                scrub: true,
                //pin:true,
                //markers: true,
                onUpdate:function(self){
                  var sideBgW = (window.innerWidth - 840) / 2;
                  gsap.to($(".cloud_area_origin .cloud_bg_area .left_bg"), 0, {width:sideBgW - (self.progress.toFixed(3) * sideBgW), ease: Linear.easeNone});
                }
              },
            });

            gsap.to(".cloud_area_origin .cloud_bg_area .right_bg", {
              scrollTrigger: {
                trigger: ".cloud_area_origin",
                start: "0 0",
                endTrigger: $(".cloud_area_origin .cloud_txt_area"),
                end:"bottom bottom",
                //pinSpacing: "padding",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                scrub: true,
                //pin:true,
                //markers: true,
                onUpdate:function(self){
                  var sideBgW = (window.innerWidth - 840) / 2;
                  gsap.to($(".cloud_area_origin .cloud_bg_area .right_bg"), 0, {width:sideBgW - (self.progress.toFixed(3) * sideBgW), ease: Linear.easeNone});
                }
              },
            });

            gsap.to(".cloud_area_origin .cloud_bg_area .bottom_bg", {
              scrollTrigger: {
                trigger: ".cloud_area_origin",
                start: "-840px 0",
                endTrigger: $(".cloud_area_origin .cloud_txt_area"),
                end:"bottom bottom",
                //pinSpacing: "padding",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                scrub: true,
                //pin:true,
                //markers: true,
              },
              height:0
            });

            gsap.to(".cloud_area_origin .cloud_bg_area .dimd_bg", {
              scrollTrigger: {
                trigger: ".cloud_area_origin",
                start: "0 0",
                endTrigger: $(".cloud_area_origin .cloud_txt_area"),
                end:"bottom bottom",
                //pinSpacing: "padding",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                scrub: true,
                //pin:true,
                //markers: true,
              },
              opacity:0.5
            });
    
            gsap.to(".cloud_area_origin .cloud_bg_area .bg", {
              scrollTrigger: {
                trigger: ".cloud_area_origin .cloud_bg_area .bg",
                start: "0 0",
                endTrigger: $(".cloud_area_origin .cloud_txt_area"),
                end:"bottom bottom",
                //end:$(".business_area .txt_box").outerHeight() + 280,
                scrub: true,
                //markers: true,
                onUpdate:function(){
                  $(".cloud_area_origin .cloud_txt_area .cloud_txt_div .of_small_tit").addClass("font_white");
                  $(".cloud_area_origin").addClass("in")
                },
                onLeaveBack:function(){
                  $(".cloud_area_origin .cloud_txt_area .cloud_txt_div .of_small_tit").removeClass("font_white")
                  $(".cloud_area_origin").removeClass("in")
                }
              },
            });
          }
        });
      }
	  /* // 2022-05-24 2차 작업 e */

      // our field overview 영역
      // if($(".sub_our_field .overview_area").size() > 0){
      //   gsap.to(".overview_area", {
      //     scrollTrigger: {
      //       trigger: ".overview_area .tit_area",
      //       start:"top-=100% 0",
      //       endTrigger: $(".overview_area .txt_area"),
      //       end:"bottom bottom",
      //       //pinSpacing: "padding",
      //       //end:$(".business_area .txt_box").outerHeight() + 280,
      //       //scrub: true,
      //       pin:true,
      //       markers: true,
      //     },
      //   });
      // }

      if($(".policy_area").size() > 0){
        ScrollTrigger.matchMedia({
          "(min-width : 1024px)": function(){
            gsap.to(".policy_area .fixed_area", {
              scrollTrigger: {
                trigger: ".policy_area .fixed_area",
                start: "-150px 0",
                endTrigger: $(".policy_area .terms_wrap"),
                end:"bottom bottom",
                pin:true,
                //markers: true,
              },
            });
          }
        });
      }



    },
    businessGnbEvt : function(){
      if($("header.business").size() > 0){

        $(window).on("scroll", function(){
          if($(window).scrollTop() >= 200){
            $("header.business").addClass("scroll")
          }else{
            $("header.business").removeClass("scroll")
          }
        });$(window).scroll();

      }
    },
    overviewEvt : function(){
      var arrTit = [];
      var arrLoc = [];
      
      $("overview_area .big_typo").css("opacity", 1);

      ezCommon.incition("overview_area .big_typo");
      $(".overview_area .big_typo span").each(function(q){
          arrTit.push($(".overview_area .big_typo span").eq(q));
      });
      $(".overview_area .big_typo").css("opacity", 1);
      TweenMax.staggerTo(arrTit, 1.1, {left:0, opacity:1, ease:Power3.easeInOut}, 0.07);
      //TweenMax.staggerTo(arrTit, 1.1, {left:0, opacity:1, ease: Linear.easeNone}, 0.07);

      // title 사라지는 효과
      gsap.to($(".overview_area .overview_tit_area"), {
        scrollTrigger: {
          trigger: ".overview_area",
          start: "top-=7% top",
          endTrigger: $(".overview_area .menu_area"),
          end: "top-=20% 10%",
          //scrub: 1,
          //markers: true,
          onUpdate: function(self){
            //console.log(self.progress.toFixed(3));
            //$(".overview_area .overview_tit_area").css("opacity", 1 - self.progress.toFixed(3));
            gsap.to($(".overview_area .overview_tit_area"), 1, {opacity:1 - self.progress.toFixed(3), ease:Power4.easeOut});
          },
        },
      });

      // fixed
      gsap.to($(".overview_area .bg_area"), {
        scrollTrigger: {
          trigger: ".overview_area .fixed_bg",
          start: "top top",
          endTrigger : "footer" ,
          end: "bottom bottom",
          scrub: 1,
          pin: true,
          //markers: true,
          onEnter: function(){
            $(".overview_area .menu_area").addClass("active");
          },
          onLeaveBack: function(){
            $(".overview_area .menu_area").removeClass("active");
          },
        },
      });

      // dimd
      gsap.to($(".overview_area .fixed_bg .bg_dimd"), {
        scrollTrigger: {
          trigger: ".overview_area .fixed_bg .bg_dimd",
          start: "top center",
          end: "bottom bottom",
          //markers: true,
          onUpdate: function(self){
            //console.log(self.progress.toFixed(3));
            $(".overview_area .fixed_bg .bg_dimd").css("opacity", self.progress.toFixed(3));
            //gsap.to($(".overview_area .overview_tit_area"), 1, {opacity:1 - self.progress.toFixed(3), ease:Power4.easeOut});
          },
        },
      });      

      // width 넓어지는 효과
      gsap.to($(".overview_area .fixed_bg .expand_area .left, .overview_area .fixed_bg .expand_area .right"), {
        scrollTrigger: {
          trigger: ".overview_area .expand_area",
          start: "top+=100px center",
          end: "bottom-=50px bottom",
          scrub: 1,
          //markers: true,
          onEnter: function(){
            $(".overview_area .expand_area").addClass("entered");
          },
          onLeaveBack: function(){
            $(".overview_area .expand_area").removeClass("entered");
          },
          onLeave: function(){
            $(".overview_area .expand_area").removeClass("entered");
            $(".overview_area .expand_area").addClass("leave");
          },
          onEnterBack: function(){
            $(".overview_area .expand_area").removeClass("leave");
          },
          onUpdate: function(self){
            if(window.innerWidth > 1023){
              gsap.to($(".overview_area .fixed_bg .expand_area .left, .overview_area .fixed_bg .expand_area .right"), 0.7, {width:120 - (self.progress.toFixed(3) * 120), ease:Power4.easeOut});
            }else{
              gsap.to($(".overview_area .fixed_bg .expand_area .left, .overview_area .fixed_bg .expand_area .right"), 0.7, {width:40 - (self.progress.toFixed(3) * 40), ease:Power4.easeOut});
            }
          },
        },
      });

      // 메뉴 hover
      $(".overview_area .menu_area .list").each(function(q){
        $(this).hover(function(){
          if($(".overview_area .menu_area").hasClass("active")){
            $(".overview_area .fixed_bg .bg .list").eq(q).addClass("top_position");
            gsap.to($(".overview_area .fixed_bg .bg .list").eq(q), 1.3, {opacity:1, ease:Power4.easeOut});
          }
        }, function(){
          if($(".overview_area .menu_area").hasClass("active")){
            $(".overview_area .fixed_bg .bg .list").removeClass("top_position");
            gsap.to($(".overview_area .fixed_bg .bg .list"), 1.3, {opacity:0, ease:Power4.easeOut});
          }
        });
      });

      $(window).resize(function(){
        //console.log("resize");
        $(".overview_area .fixed_bg").css("width", window.innerWidth);
        $(".overview_area .fixed_bg .bg").css("width", window.innerWidth);
        $(".overview_area .fixed_bg .expand_area").css("width", window.innerWidth);
      }).resize();
    },
    agreeEvt: function(){
      $(".circle_chk label a").on("click", function(event){
        //event.stopPropagation();
        event.preventDefault();
        //console.log(123);
      });
    },
  }
})();

$(window).load(function(){
  subScript.deviceChk();
  subScript.commonMotion();
  subScript.subMotion();
  subScript.swiperEvt();
  subScript.resizeEvt();
  subScript.scrollMotion();
  subScript.triggerEvt();
  subScript.businessGnbEvt();
  subScript.overviewEvt();
  subScript.agreeEvt();
});

function europeTrigger(){
  // about us 사업장 유럽법인 career
  if($(".business_area .working_sec").size() > 0){
    ScrollTrigger.matchMedia({
      "(min-width : 1024px)": function(){
        gsap.to(".working_sec .right_div", {
          scrollTrigger: {
            trigger: ".working_sec .left_div .sub_tit",
            start: "-200px 0",
            endTrigger: $(".working_sec .right_div"),
            end:"bottom bottom",
            //end:$(".business_area .txt_box").outerHeight() + 280,
            //scrub: true,
            pin:true,
            //markers: true,
          },
        });
      }
    });
  }
}

function scrollMotionTrigger(){
  if($(".scrollMotion").size() > 0 || $(".scrollMotion2").size() > 0){
    $(".scrollMotion:visible").each(function(q){
      gsap.to($(this), {
        scrollTrigger: {
          trigger: $(this),
          start: "top 83%",
          end:"bottom center",
          toggleClass: {targets: $(".scrollMotion:visible").eq(q), className: "active"},
          once: true,
          //markers: true,
        },
      });
    });

    $(".scrollMotion2:visible").each(function(q){
      gsap.to($(this), {
        scrollTrigger: {
          trigger: $(this),
          start: "top 90%",
          end:"bottom center",
          toggleClass: {targets: $(".scrollMotion2:visible").eq(q), className: "active"},
          once: true,
          //markers: true,
        },
      });
    });
  }
}

// 2021-07-16 호출함수로 분리
function businessHeaderFocusMove(){
  /* about us - 사업장 헤더 포커싱 이동 */
  if($(".business_area").size() > 0 && $(".business_area.europe").size() <= 0){
    $("header.business .one_depth").each(function(q){
      $(this).on("click", function(){
        $(".business_area").show();

        var thisText = $(this).text();

        if(window.innerWidth < 768){
          $("header.business .current").removeClass("on")
          $("header.business .current").text(thisText)
          $("header.business .gnb").stop(true,true).slideUp();
        }

        if(window.innerWidth < 768){
          if(q == 2){
            TweenMax.to($("html, body"), 0, {scrollTop:$(".business_area section").eq(q).offset().top - 50, ease:Power3.easeOut});
          }else{
            TweenMax.to($("html, body"), 0, {scrollTop:$(".business_area section").eq(q).offset().top - 100, ease:Power3.easeOut});
          }
        }else{
          if(q == 2){
            TweenMax.to($("html, body"), 0, {scrollTop:$(".business_area section").eq(q).offset().top - 100, ease:Power3.easeOut});
          }else{
            TweenMax.to($("html, body"), 0, {scrollTop:$(".business_area section").eq(q).offset().top - 150, ease:Power3.easeOut});
          }
        }
        
      });
    });
  }
}

// 2021-07-16 호출함수로 분리
function europeHeaderTabMove(){
  // about us 유럽 법인 tab 이동
  if($(".europe_tab_con").size() > 0){
    $("header.business .one_depth").attr("title","선택안됨");
    $("header.business .one_depth").each(function(q){
      $("header.business .one_depth").eq(0).attr("title","선택됨");
      $(this).on("click", function(){
        var thisText = $(this).text();
  
        $("*").not(".sub_visual").removeClass("active")
        TweenMax.to($("html, body"), 0, {scrollTop:0})
        $("header.business .one_depth").attr("title","선택안됨");
        $(this).attr("title", "선택됨");
        $(".europe_tab_con").removeClass("on");
        $(".europe_tab_con").eq(q).addClass("on");
        europeTrigger();
        $(window).scroll();
  
        scrollMotionTrigger();
  
        if(window.innerWidth < 768){
          $("header.business .current").removeClass("on");
          $("header.business .current").text(thisText);
          $("header.business .gnb").stop(true, true).slideUp();
        }
      });
    })
  }
}



var ezCommon = (function(){
  return {
      incition : function (cls) {
          var arrTxt = $("." + cls).text().trim().split("");
          $("." + cls).text("");
          for(var i=0; i<arrTxt.length; i++) {
              $("." + cls).append("<span>" + arrTxt[i] + "</span>");
          }
      },
      
      lotto : function (s,e,l) {
          var lt = new Array(l);
          var count = 0;
          var isOverlap = true;

          while (count < l) {
              var number = 0;
              number = Math.floor(Math.random() * e) + 1;
              for(var i=s; i<count; i++) {
                  if(lt[i] == number) {
                      isOverlap = false;
                  }
              }

              if(isOverlap) {
                  lt[count] = number;
                  count++;
              }

              isOverlap = true;
          }

          return lt;
      }, // lotto

      random : function(e){
          var number = Math.floor(Math.random() * e) + 1;
          return number;
      },

      upperCase : function (str) {
          var s = $("." + str).text().trim().toUpperCase();
          $("." + str).text(s);
      },

      lowerCase : function (str) {
          var s = $("." + str).text().trim().toLowerCase();
          $("." + str).text(s);
      }
  }
})();